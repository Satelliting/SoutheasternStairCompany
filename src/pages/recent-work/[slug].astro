---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
  const projects = await getCollection("recent-work");
  return projects.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
---

<Layout title={entry.data.title} description={entry.data.description}>
  <article class="py-12 md:py-20" aria-labelledby="project-title">
    <div class="container mx-auto px-4 max-w-4xl">
      <nav aria-label="Breadcrumb" class="mb-8">
        <a
          href="/recent-work"
          class="inline-flex items-center text-sm font-bold uppercase tracking-widest text-brand-secondary hover:text-brand-primary transition-colors focus:outline-none focus:ring-2 focus:ring-brand-primary"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-4 w-4 mr-2"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            aria-hidden="true"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
          </svg>
          Back to Portfolio
        </a>
      </nav>

      <header class="mb-8 md:mb-12">
        <div class="flex flex-wrap items-center gap-4 mb-4">
          <span
            class="text-[10px] md:text-xs font-bold uppercase tracking-widest text-brand-secondary bg-brand-light px-3 py-1 rounded"
          >
            {entry.data.category}
          </span>
          <time
            datetime={entry.data.publishDate.toISOString()}
            class="text-xs md:text-sm text-gray-500"
          >
            {
              entry.data.publishDate.toLocaleDateString("en-US", {
                year: "numeric",
                month: "long",
                day: "numeric",
              })
            }
          </time>
        </div>
        <h1
          id="project-title"
          class="text-3xl md:text-5xl uppercase mb-6 font-bold leading-tight"
        >
          {entry.data.title}
        </h1>
        <p
          class="text-lg md:text-xl text-gray-600 italic border-l-4 border-brand-primary pl-6 leading-relaxed"
        >
          {entry.data.description}
        </p>
      </header>

      <div
        class="mb-8 md:mb-12 rounded-lg overflow-hidden shadow-xl md:shadow-2xl bg-gray-100 aspect-video md:aspect-auto"
      >
        <img
          src={entry.data.image}
          alt={`Gallery image for ${entry.data.title}`}
          class="w-full h-full object-cover"
          width="1200"
          height="800"
        />
      </div>

      <div
        class="prose prose-base md:prose-lg max-w-none prose-headings:uppercase prose-headings:font-serif prose-brand"
      >
        <Content />
      </div>

      <div
        class="mt-12 md:mt-16 pt-8 border-t border-gray-100 flex flex-col md:flex-row justify-between items-center gap-6"
      >
        <h3
          class="text-lg md:text-xl uppercase font-bold text-center md:text-left"
        >
          Interested in a project like this?
        </h3>
        <a
          href="/contact"
          class="bg-brand-dark text-white px-10 py-4 uppercase tracking-widest font-bold hover:bg-brand-primary transition-colors focus:outline-none focus:ring-2 focus:ring-brand-primary rounded shadow-md w-full md:w-auto text-center text-sm md:text-base"
        >
          Get Started
        </a>
      </div>
    </div>
  </article>
</Layout>

<style is:global>
  @reference "../../styles/global.css";

  .prose h2 {
    @apply text-2xl mt-12 mb-6 text-brand-dark;
  }
  .prose p {
    @apply text-gray-600 leading-relaxed mb-6;
  }
  .prose ul {
    @apply list-disc pl-6 mb-6 space-y-2 text-gray-600;
  }
</style>
